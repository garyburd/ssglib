<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<style>*, *::before, *::after { box-sizing: border-box; }
body {
  color: #111;
  background-color: #fefefe;
  max-width: 50rem;
  padding: 0 1rem 1rem 1rem;
  margin: 0 auto;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;
  line-height: 1.5;
}
nav.top ul { display: flex; flex-wrap: wrap; list-style: none; margin: 0; padding: 0; align-items: end; }
nav.top li:not(:first-child)::before { display: inline-block; margin: 0 0.25rem; content: "|"; }
nav.top li:first-child { font-weight: bold; font-size: 1.13em; }
nav.top a { text-decoration: none; }
nav.top a:hover { text-decoration: underline; }
body > header { margin-top: 1.25rem; margin-bottom: 1.7rem; }
a { color: #0366d6; }
a:hover { color: #0550ae; }
pre { background-color: #f6f8fa; padding: 1em; overflow-x: auto; border-radius: 6px; }
code { font-size: 0.9em; }
:not(pre) > code { background-color: #f6f8fa; padding: 0.15em 0.3em; border-radius: 3px; }
article > h1 { margin-bottom: 0.5rem; }
.callout { border-left: 3px solid #d0d7de; padding: 0.5em 1em; margin: 1em 0; }
.callout-note { border-left-color: #0366d6; }
.callout-warning { border-left-color: #d29922; }
</style>
<title>ssglib – Vault</title>
</head>
<body>
<header><nav class="top">
<ul>
<li><a href="/ssglib/" title="Home">ssglib</a></li>
</ul>
</nav></header>
<main>
<article><h1>Vault</h1>
<p>The <code>ssglib.vault</code> module reads an Obsidian vault
directory, caches file metadata, and provides access to vault files.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">vault</span> <span class="op">=</span> <span class="fu">require</span> <span class="st">&quot;ssglib.vault&quot;</span></span></code></pre></div>
<h2>Vault.load(vault_path, cache_path)</h2>
<p>Load a vault from <code>vault_path</code>. File metadata is cached at
<code>cache_path</code> to speed up subsequent builds. Only files whose
modification time has changed are re-read.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">v</span> <span class="op">=</span> <span class="va">vault</span><span class="op">.</span><span class="va">Vault</span><span class="op">.</span>load<span class="op">(</span><span class="st">&quot;vault&quot;</span><span class="op">,</span> <span class="st">&quot;docs/.cache.json&quot;</span><span class="op">)</span></span></code></pre></div>
<h2>Vault:get(path)</h2>
<p>Look up a file by its vault-relative path. The <code>.md</code>
extension is optional for notes.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">f</span> <span class="op">=</span> <span class="va">v</span><span class="op">:</span>get<span class="op">(</span><span class="st">&quot;Getting Started&quot;</span><span class="op">)</span>  <span class="co">-- finds &quot;Getting Started.md&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">local</span> <span class="va">f</span> <span class="op">=</span> <span class="va">v</span><span class="op">:</span>get<span class="op">(</span><span class="st">&quot;images/photo.jpg&quot;</span><span class="op">)</span></span></code></pre></div>
<p>Returns a <code>File</code> or <code>nil</code>.</p>
<h2>Vault:notes()</h2>
<p>Return a <code>pandoc.List</code> of all note files in the vault.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="va">f</span> <span class="kw">in</span> <span class="va">v</span><span class="op">:</span>notes<span class="op">():</span>iter<span class="op">()</span> <span class="cf">do</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span><span class="op">(</span><span class="va">f</span><span class="op">:</span>title<span class="op">())</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code></pre></div>
<h2>File</h2>
<p>A <code>File</code> represents a single file in the vault.</p>
<h3>Fields</h3>
<ul>
<li><code>path</code> – Vault-relative path in POSIX format (e.g.,
<code>"articles/Hello World.md"</code>)</li>
<li><code>file_path</code> – Absolute file system path</li>
<li><code>mtime</code> – Modification time in ISO 8601 format</li>
<li><code>properties</code> – Table of file metadata from front matter
or image headers</li>
</ul>
<h3>File:type()</h3>
<p>Returns the file type: <code>"note"</code> for <code>.md</code>
files, <code>"image"</code> for image files, or
<code>"other"</code>.</p>
<h3>File:title()</h3>
<p>Returns the file name without directory or extension.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- For path &quot;articles/Hello World.md&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="va">f</span><span class="op">:</span>title<span class="op">()</span>  <span class="co">-- &quot;Hello World&quot;</span></span></code></pre></div>
<h3>File:url()</h3>
<p>Returns the URL for the file. If the front matter includes a
<code>permalink</code> property, that value is used. Otherwise, the URL
is derived from the path with spaces replaced by hyphens.</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- With permalink: &quot;hello/&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="va">f</span><span class="op">:</span>url<span class="op">()</span>  <span class="co">-- &quot;/hello/&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- Without permalink, path &quot;articles/Hello World.md&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="va">f</span><span class="op">:</span>url<span class="op">()</span>  <span class="co">-- &quot;/articles/Hello-World/&quot;</span></span></code></pre></div>
<h3>File:doc()</h3>
<p>Parse the file and return a <code>pandoc.Doc</code>. Obsidian-style
image wikilinks (<code>![[image.png]]</code>) are converted to standard
Pandoc <code>Image</code> elements.</p>
<h2>format_date(fmt, date)</h2>
<p>Format an ISO 8601 date string using <code>os.date</code> format
specifiers.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode lua"><code class="sourceCode lua"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="va">vault</span><span class="op">.</span>format_date<span class="op">(</span><span class="st">&quot;%B %Y&quot;</span><span class="op">,</span> <span class="st">&quot;2025-03-15&quot;</span><span class="op">)</span>  <span class="co">-- &quot;March 2025&quot;</span></span></code></pre></div></article>
</main>
</body>
</html>
